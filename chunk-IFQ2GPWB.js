import{a as j}from"./chunk-KNXID2YS.js";import"./chunk-74ISNC3D.js";import"./chunk-PFKTXGOQ.js";import{a as C,b as O,e as L}from"./chunk-MNXY6R3H.js";import{m as P,n as k,p as v}from"./chunk-LG3ESZ4H.js";import{Bb as m,Bd as T,Cd as F,Fd as b,Id as y,Lc as A,Mb as d,Nb as D,Ra as c,Sa as r,Vb as u,Wc as w,X as g,Zd as I,dc as E,ec as M,g as p,ib as x,kb as f,ub as a,vb as s,wb as h}from"./chunk-IFPKIGQ4.js";function H(o,n){o&1&&(a(0,"div",8)(1,"h3"),d(2,"Add Channel"),s(),a(3,"p"),d(4,"Add a new region to your crm."),s()())}function V(o,n){o&1&&(a(0,"div",8)(1,"h3"),d(2,"Edit Channel"),s(),a(3,"p"),d(4,"Edit region to your crm."),s()())}var _=(()=>{let n=class n{constructor(e,t,i,l,S){this.dialogService=e,this.ref=t,this.config=i,this.dataTableService=l,this.dataService=S,this.type="",this.configs=[{controlName:"title",type:"text",label:"Title",name:"Title",placeholder:"Channel Title",validators:[y.required],styleClass:"col-md-12 p-0 mt-3"},{controlName:"code",type:"text",label:"Code",name:"Code",placeholder:"Code",validators:[y.required],styleClass:"col-md-12 p-0 mt-3"}],this.subscription=new p,console.log("data",this.config.data),i.data!=null?this.type="Edit":this.type="Add"}handlingFormActions(e){this.formActions=e,this.type==="Edit"&&setTimeout(()=>{this.Edit()},0)}Edit(){this.formActions.setFormControlValue("title",this.config.data.title),this.formActions.setFormControlValue("code",this.config.data.code)}submit(){if(this.type==="Add"){let e=this.formActions.getFormData();this.subscription.add(this.dataService.postFn("channel/add",e).subscribe(t=>{}))}else if(this.type==="Edit"){let e=this.formActions.getFormData();console.log("formData",e),this.subscription.add(this.dataService.putFnById(this.config.data.channel_id,"channel/update/",e).subscribe(t=>{console.log("result",t)}))}}};n.\u0275fac=function(t){return new(t||n)(r(v),r(k),r(P),r(C),r(b))},n.\u0275cmp=g({type:n,selectors:[["engaz-add-channel"]],standalone:!0,features:[u],decls:13,vars:3,consts:[[1,"addChannel"],[1,"header"],[1,"bi","bi-chat-left-text"],["class","",4,"ngIf"],[3,"config","events"],[1,"btns"],[1,"btn","gray","mx-3"],[1,"btn","thirdy",3,"click"],[1,""]],template:function(t,i){t&1&&(a(0,"div",0)(1,"div",1),h(2,"i",2),x(3,H,5,0,"div",3)(4,V,5,0,"div",3),s(),h(5,"hr"),a(6,"app-form",4),m("events",function(S){return i.handlingFormActions(S)}),s(),h(7,"hr"),a(8,"div",5)(9,"button",6),d(10,"Cancel"),s(),a(11,"button",7),m("click",function(){return i.submit()}),d(12,"Save"),s()()()),t&2&&(c(3),f("ngIf",i.type==="Add"),c(),f("ngIf",i.type==="Edit"),c(2),f("config",i.configs))},dependencies:[w,A,I,j],styles:[".addChannel[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;position:absolute;top:6.5%}.addChannel[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;line-height:28px;letter-spacing:0em;text-align:left;margin-bottom:0}.addChannel[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{border:1px solid #EAECF0;box-shadow:0 1px 2px #1018280d;padding:0 12px;font-size:20px;border-radius:10px;display:flex;align-items:center;margin:0 10px}.addChannel[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:0}.addChannel[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{width:107.3%;margin-left:-24px;color:#eaecf0}"]});let o=n;return o})();var te=(()=>{let n=class n{constructor(e,t,i,l){this.dataTableService=e,this.dataService=t,this.sharedModalService=i,this.dialogService=l,this.subscription=new p,this.skip=0,this.take=10,this.allChannels=[],this.columns=[{field:"title",header:"TITLE",type:"text",canSort:!1},{field:"code",header:"CODE",type:"text",canSort:!1}],this.actions=[{label:"EDIT",icon:"assets/images/edit-action.svg",function:this.onEdit.bind(this),btnConditionBasedField:""},{label:"DELETE",icon:"assets/images/delete-action.svg",function:this.onDelete.bind(this),btnConditionBasedField:""}],e.cols=this.columns,e.isLoading=!1,e.hasPaginator=!0,e.hasFlatActions=!0,e.actionsFlat=this.actions}ngOnInit(){this.getData(),this.getPageChanged()}getData(){this.dataTableService.isLoading=!0,this.subscription.add(this.dataService.getFn(`channel/get/bulk/${this.skip}/${this.take}`).subscribe(e=>{this.dataTableService.isLoading=!1,this.dataTableService.totalRecords=e?.total,this.dataTableService.rows.set(e?.list)}))}onEdit(e){this.ref=this.dialogService.open(_,{width:"50vw",modal:!0,breakpoints:{"960px":"75vw","640px":"90vw"},data:e})}onDelete(e){let t={title:"Are you sure to delete this channel?",message:"",type:"error",btnLabel:"DELETE"};this.sharedModalService.confirmCard(t).onClose.subscribe(i=>{i=="confirm"&&this.deleteChannel(e)})}deleteChannel(e){let t=e.channel_id;this.subscription.add(this.dataService.deleteFn(`channel/delete/${t}`).subscribe(i=>{i?.status?this.sharedModalService.successBasicCard({title:"Channel Deleted Successfully",btnLabel:"THANK_YOU"}).onClose.subscribe(l=>{this.getData()}):this.getAllChannel(t)}))}reassign(e){this.subscription.add(this.dataService.postFn("channel/terminate",{newchannel:this.sharedModalService.selectedItemReassigned?.id,oldchannel:e}).subscribe(()=>{this.sharedModalService.successBasicCard({title:"Assigned Successfully",btnLabel:"THANK_YOU"}).onClose.subscribe(()=>{this.getData()})}))}handleReasign(e){this.sharedModalService.reassignModal({items:this.allChannels,title:"Assign Channel"}).onClose.subscribe(t=>{t=="reassign"&&this.reassign(e)})}getPageChanged(){this.subscription.add(this.dataTableService.getPageChanged().subscribe(e=>{this.skip=e.page*e.rows,this.take=e.rows,this.getData()}))}newChannel(){this.ref=this.dialogService.open(_,{width:"50vw",modal:!0,breakpoints:{"960px":"75vw","640px":"90vw"}})}getAllChannel(e){this.subscription.add(this.dataService.getFn("channel/get/bulk/0/-1").subscribe(t=>{let i=t?.list;this.allChannels=i.map(l=>({title:l.title,id:l.channel_id})),this.handleReasign(e)}))}ngOnDestroy(){this.subscription.unsubscribe(),this.sharedModalService.selectedItemReassigned={}}};n.\u0275fac=function(t){return new(t||n)(r(C),r(b),r(L),r(v))},n.\u0275cmp=g({type:n,selectors:[["app-channels-list"]],standalone:!0,features:[u],decls:9,vars:3,consts:[[1,"p-4"],[1,"d-flex","justify-content-between","mb-3"],[1,"btn","bg-btn","text-white",3,"click"],[1,"position-relative","shadow","rounded"]],template:function(t,i){t&1&&(a(0,"div",0)(1,"div",1)(2,"h3"),d(3),E(4,"translate"),s(),a(5,"button",2),m("click",function(){return i.newChannel()}),d(6,"New Channel"),s()(),a(7,"div",3),h(8,"data-table"),s()()),t&2&&(c(3),D(M(4,1,"CHANNEL_LIST")))},dependencies:[O,F,T],changeDetection:0});let o=n;return o})();export{te as ChannelsListComponent};
