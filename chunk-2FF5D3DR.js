import{a as k}from"./chunk-KNXID2YS.js";import"./chunk-74ISNC3D.js";import"./chunk-PFKTXGOQ.js";import{a as F,b as P,e as O}from"./chunk-MNXY6R3H.js";import{m as T,p as I}from"./chunk-LG3ESZ4H.js";import{Ad as x,Bb as m,Bd as D,Cd as M,Fd as f,Id as E,Mb as c,Nb as y,Ra as u,Sa as o,Vb as g,Wc as _,X as p,Zd as A,dc as S,ec as w,g as h,kb as C,ub as a,vb as s,wb as l}from"./chunk-IFPKIGQ4.js";var v=(()=>{let i=class i{constructor(e,t){this.dataService=e,this.config=t,this.type="",this.subscription=new h,this.configs=[{controlName:"title",type:"text",label:"Title",name:"Title",placeholder:"Title",validators:[E.required],styleClass:"col-md-12 p-0 mt-3"}],t.data!=null?this.type="Edit":this.type="Add"}handlingFormActions(e){this.formActions=e,this.type==="Edit"&&setTimeout(()=>{this.Edit()},0)}Edit(){this.formActions.setFormControlValue("title",this.config.data.title)}submit(){if(this.type==="Add"){let e=this.formActions.getFormData();this.subscription.add(this.dataService.postFn("communicateway/add",e).subscribe(t=>{}))}else if(this.type==="Edit"){let e=this.formActions.getFormData();this.subscription.add(this.dataService.putFnById(this.config.data.communicate_way_id,"communicateway/update/",e).subscribe(t=>{}))}}};i.\u0275fac=function(t){return new(t||i)(o(f),o(T))},i.\u0275cmp=p({type:i,selectors:[["engaz-add-communication"]],standalone:!0,features:[g],decls:16,vars:1,consts:[[1,"addChannel"],[1,"header"],[1,"bi","bi-tag"],[1,""],[3,"config","events"],[1,"btns"],[1,"btn","gray","mx-3"],[1,"btn","thirdy",3,"click"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1),l(2,"i",2),a(3,"div",3)(4,"h3"),c(5,"Add CommunicationWay"),s(),a(6,"p"),c(7,"Add a new Communications to your crm."),s()()(),l(8,"hr"),a(9,"app-form",4),m("events",function(b){return n.handlingFormActions(b)}),s(),l(10,"hr"),a(11,"div",5)(12,"button",6),c(13,"Cancel"),s(),a(14,"button",7),m("click",function(){return n.submit()}),c(15,"Save"),s()()()),t&2&&(u(9),C("config",n.configs))},dependencies:[_,A,k],styles:[".addChannel[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;position:absolute;top:6.5%}.addChannel[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;line-height:28px;letter-spacing:0em;text-align:left;margin-bottom:0}.addChannel[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{border:1px solid #EAECF0;box-shadow:0 1px 2px #1018280d;padding:0 12px;font-size:20px;border-radius:10px;display:flex;align-items:center;margin:0 10px}.addChannel[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:0}.addChannel[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{width:107.3%;margin-left:-24px;color:#eaecf0}"]});let d=i;return d})();var J=(()=>{let i=class i{constructor(e,t,n,r,b){this.dialogService=e,this.dataTableService=t,this.translate=n,this.dataService=r,this.sharedModalService=b,this.subscription=new h,this.skip=0,this.take=10,this.allLandPages=[],this.columns=[{field:"title",header:"TITLE",type:"text",canSort:!1}],this.actions=[{label:"EDIT",icon:"assets/images/edit-action.svg",function:this.onEdit.bind(this),btnConditionBasedField:""},{label:"DELETE",icon:"assets/images/delete-action.svg",function:this.onDelete.bind(this),btnConditionBasedField:""}],t.cols=this.columns,t.isLoading=!1,t.hasPaginator=!0,t.hasFlatActions=!0,t.actionsFlat=this.actions}ngOnInit(){this.getData(),this.getPageChanged()}getData(){this.dataTableService.isLoading=!0,this.subscription.add(this.dataService.getFn(`communicateway/get/bulk/${this.skip}/${this.take}`).subscribe(e=>{this.dataTableService.isLoading=!1,this.dataTableService.totalRecords=e?.total,this.dataTableService.rows.set(e?.list)}))}addCommunication(){this.ref=this.dialogService.open(v,{width:"50vw",modal:!0,breakpoints:{"960px":"75vw","640px":"90vw"}})}onEdit(e){console.log("ff",e),this.ref=this.dialogService.open(v,{width:"50vw",modal:!0,breakpoints:{"960px":"75vw","640px":"90vw"},data:e})}onDelete(e){let t={title:"Are you sure to delete this Communication Way?",message:"",type:"error",btnLabel:"DELETE"};this.sharedModalService.confirmCard(t).onClose.subscribe(n=>{n=="confirm"&&this.deleteCommunicateWay(e)})}deleteCommunicateWay(e){let t=e.communicate_way_id;this.subscription.add(this.dataService.deleteFn(`communicateway/delete/${t}`).subscribe(n=>{n?.status?this.sharedModalService.successBasicCard({title:"Communication Way Deleted Successfully",message:"",btnLabel:"OKAY"}).onClose.subscribe(r=>{this.getData()}):this.getAllItems(t)}))}reassign(e){this.subscription.add(this.dataService.postFn("communicateway/terminate",{newcommunicateWay:this.sharedModalService.selectedItemReassigned?.id,oldcommunicateWay:e}).subscribe(()=>{this.sharedModalService.successBasicCard({title:"Assigned Successfully",btnLabel:"THANK_YOU"}).onClose.subscribe(()=>{this.getData()})}))}handleReasign(e){this.sharedModalService.reassignModal({items:this.allLandPages,title:"Assign Communicate Way"}).onClose.subscribe(t=>{t=="reassign"&&this.reassign(e)})}getPageChanged(){this.subscription.add(this.dataTableService.getPageChanged().subscribe(e=>{this.skip=e.page*e.rows,this.take=e.rows,this.getData()}))}getAllItems(e){this.subscription.add(this.dataService.getFn("communicateway/get/bulk/0/-1").subscribe(t=>{let n=t?.list;this.allLandPages=n.map(r=>({title:r.title,id:r.communicate_way_id})),this.handleReasign(e)}))}ngOnDestroy(){this.subscription.unsubscribe(),this.sharedModalService.selectedItemReassigned={}}};i.\u0275fac=function(t){return new(t||i)(o(I),o(F),o(x),o(f),o(O))},i.\u0275cmp=p({type:i,selectors:[["app-communication-way-list"]],standalone:!0,features:[g],decls:9,vars:3,consts:[[1,"p-4"],[1,"d-flex","justify-content-between","mb-3"],[1,"btn","bg-btn","text-white",3,"click"],[1,"position-relative","shadow","rounded"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1)(2,"h3"),c(3),S(4,"translate"),s(),a(5,"button",2),m("click",function(){return n.addCommunication()}),c(6," New Communications "),s()(),a(7,"div",3),l(8,"data-table"),s()()),t&2&&(u(3),y(w(4,1,"communicationsway")))},dependencies:[P,M,D],changeDetection:0});let d=i;return d})();export{J as CommunicationWayListComponent};
